# 補給管理システム - 開発環境構築ドキュメント

## プロジェクト概要

### 目的
Java/Spring Boot、JavaScript/TypeScript/Reactの学習を目的とした補給管理システムの構築

### システムの主要機能
- 補給品マスタ管理（登録・編集・削除・一覧表示）
- 在庫管理（入庫・出庫登録、在庫照会）
- ファイル入出力（CSVインポート、Excelエクスポート）
- 画面入力とファイル入出力の両方に対応

---

## 技術スタック

### バックエンド
- **言語:** Java 17
- **フレームワーク:** Spring Boot 3.2.0
- **ORM:** MyBatis 3.0.3
- **ビルドツール:** Gradle
- **データベース:** H2 Database (開発用組み込み)
- **API仕様書:** Swagger (springdoc-openapi 2.3.0)
- **ファイル処理:** Apache Commons CSV, Apache POI

### フロントエンド
- **言語:** JavaScript + TypeScript
- **フレームワーク:** React 18.2.0
- **ビルドツール:** Vite 5.0.8
- **ルーティング:** React Router 6.20.0
- **HTTP通信:** Axios 1.6.2

### 開発環境
- **エディタ:** VSCode
- **OS:** WSL (Windows Subsystem for Linux)
- **アプリケーションサーバー:** Apache Tomcat

### 推奨VSCode拡張機能
- Extension Pack for Java
- Spring Boot Extension Pack
- ES7+ React/Redux/React-Native snippets
- REST Client (API テスト用)

---

## プロジェクト構造

```
supply-management-system/
├── backend/                           # Spring Boot API
│   ├── src/
│   │   ├── main/
│   │   │   ├── java/com/example/supply/
│   │   │   │   ├── controller/       # REST API Controller
│   │   │   │   ├── service/          # ビジネスロジック
│   │   │   │   ├── mapper/           # MyBatis Mapper Interface
│   │   │   │   ├── dto/              # Data Transfer Object
│   │   │   │   ├── entity/           # Entity (Domain Model)
│   │   │   │   ├── config/           # 設定クラス
│   │   │   │   ├── util/             # ユーティリティ
│   │   │   │   └── SupplyApplication.java
│   │   │   └── resources/
│   │   │       ├── application.yml   # アプリケーション設定
│   │   │       ├── schema.sql        # DDL (テーブル定義)
│   │   │       ├── data.sql          # 初期データ
│   │   │       └── mapper/           # MyBatis XMLマッパー
│   │   │           └── SupplyMapper.xml
│   │   └── test/                     # テストコード
│   ├── build.gradle                  # Gradle設定
│   └── README.md
│
├── frontend/                          # React Application
│   ├── public/
│   │   └── index.html
│   ├── src/
│   │   ├── components/               # Reactコンポーネント
│   │   │   ├── common/               # 共通コンポーネント
│   │   │   │   ├── Header.tsx
│   │   │   │   ├── Sidebar.tsx
│   │   │   │   └── FileUpload.tsx
│   │   │   └── supply/               # 補給品関連コンポーネント
│   │   │       ├── SupplyList.tsx
│   │   │       ├── SupplyForm.tsx
│   │   │       └── SupplyDetail.tsx
│   │   ├── pages/                    # ページコンポーネント
│   │   │   ├── Dashboard.tsx
│   │   │   ├── SupplyManagement.tsx
│   │   │   └── FileImport.tsx
│   │   ├── services/                 # API通信
│   │   │   ├── api.ts
│   │   │   └── supplyService.ts
│   │   ├── types/                    # TypeScript型定義
│   │   │   ├── supply.ts
│   │   │   └── common.ts
│   │   ├── hooks/                    # カスタムフック
│   │   │   └── useSupplies.ts
│   │   ├── utils/                    # ユーティリティ
│   │   │   └── fileHelper.ts
│   │   ├── App.tsx
│   │   ├── main.tsx
│   │   └── vite-env.d.ts
│   ├── package.json                  # npm設定
│   ├── tsconfig.json                 # TypeScript設定
│   ├── vite.config.ts                # Vite設定
│   └── README.md
│
└── README.md                          # プロジェクト全体のREADME
```

---

## バックエンド設定

### build.gradle

#### 主要な設定項目
- **Javaバージョン:** 17
- **Spring Bootバージョン:** 3.2.0
- **主要な依存関係:**
  - spring-boot-starter-web
  - mybatis-spring-boot-starter (3.0.3)
  - h2database
  - springdoc-openapi-starter-webmvc-ui (2.3.0)
  - commons-csv (1.10.0)
  - poi-ooxml (5.2.5)
  - lombok (オプション)

### application.yml

#### 主要な設定項目
- **アプリケーション名:** supply-management-system
- **H2 Database設定:**
  - URL: jdbc:h2:mem:supplydb
  - Driver: org.h2.Driver
  - Username: sa
  - Password: (空白)
- **H2 Console:**
  - 有効化: true
  - パス: /h2-console
- **MyBatis設定:**
  - マッパーロケーション: classpath:mapper/**/*.xml
  - 型エイリアス: com.example.supply.entity
  - キャメルケース変換: 有効
- **Swagger設定:**
  - API Docs パス: /api-docs
  - Swagger UI パス: /swagger-ui.html

### MyBatis構成

#### Mapper Interface
- パッケージ: com.example.supply.mapper
- アノテーション: @Mapper
- 主要なメソッド: findAll, findById, insert, update, delete

#### XML Mapper
- 配置場所: src/main/resources/mapper/
- ファイル名: SupplyMapper.xml
- 名前空間: com.example.supply.mapper.SupplyMapper
- SQL操作: SELECT, INSERT, UPDATE, DELETE

---

## フロントエンド設定

### package.json

#### 主要な設定項目
- **名前:** supply-frontend
- **バージョン:** 1.0.0
- **ビルドツール:** Vite
- **スクリプト:**
  - dev: 開発サーバー起動
  - build: 本番ビルド
  - preview: ビルド結果のプレビュー
- **主要な依存関係:**
  - react (^18.2.0)
  - react-dom (^18.2.0)
  - react-router-dom (^6.20.0)
  - axios (^1.6.2)
- **開発依存関係:**
  - @types/react (^18.2.43)
  - @types/react-dom (^18.2.17)
  - @vitejs/plugin-react (^4.2.1)
  - typescript (^5.3.3)
  - vite (^5.0.8)

### tsconfig.json

#### 主要な設定項目
- **ターゲット:** ES2020
- **モジュール:** ESNext
- **JSX:** react-jsx
- **Strict モード:** 有効
- **モジュール解決:** bundler
- **主要なコンパイラオプション:**
  - 厳密な型チェック
  - 未使用変数の検出
  - 未使用パラメータの検出
  - switch文のフォールスルー検出

### TypeScript型定義

#### 主要な型
- **Supply:** 補給品の型定義
  - id, name, quantity, unitPrice, category, createdAt, updatedAt
- **SupplyFormData:** フォーム入力用の型定義
  - name, quantity, unitPrice, category
- **InventoryTransaction:** 在庫トランザクションの型定義
  - id, supplyId, type ('IN' | 'OUT'), quantity, transactionDate, note

### API Service

#### api.ts
- Axiosインスタンスの設定
- ベースURL: http://localhost:8080/api
- Content-Type: application/json

#### supplyService.ts
補給品管理用のAPIサービス。以下のメソッドを提供：
- **getAll():** 補給品一覧取得
- **getById(id):** 補給品詳細取得
- **create(data):** 補給品登録
- **update(id, data):** 補給品更新
- **delete(id):** 補給品削除
- **importCsv(file):** CSVファイルインポート
- **exportExcel():** Excelファイルエクスポート

---

## API設計

### エンドポイント一覧

#### 補給品管理
```
GET    /api/supplies          # 補給品一覧取得
GET    /api/supplies/{id}     # 補給品詳細取得
POST   /api/supplies          # 補給品登録
PUT    /api/supplies/{id}     # 補給品更新
DELETE /api/supplies/{id}     # 補給品削除
```

#### ファイル操作
```
POST   /api/supplies/import   # CSVインポート
GET    /api/supplies/export   # Excelエクスポート
```

#### 在庫管理
```
GET    /api/inventory         # 在庫一覧取得
POST   /api/inventory/in      # 入庫登録
POST   /api/inventory/out     # 出庫登録
```

### Swagger UI アクセス
- **Swagger UI:** http://localhost:8080/swagger-ui.html
- **API JSON:** http://localhost:8080/api-docs

---

## データベース設定

### H2 Database

#### 特徴
- インメモリデータベース（開発・学習用に最適）
- 設定不要で簡単に起動
- ブラウザでDB内容を確認可能

#### H2 Console アクセス
- **URL:** http://localhost:8080/h2-console
- **JDBC URL:** jdbc:h2:mem:supplydb
- **ユーザー名:** sa
- **パスワード:** (空白)

#### スキーマ構成 (schema.sql)

**suppliesテーブル:**
- id (主キー, 自動採番)
- name (品名)
- quantity (数量)
- unit_price (単価)
- category (カテゴリ)
- created_at (作成日時)
- updated_at (更新日時)

**inventory_transactionsテーブル:**
- id (主キー, 自動採番)
- supply_id (補給品ID, 外部キー)
- type (IN/OUT)
- quantity (数量)
- transaction_date (取引日時)
- note (備考)

---

## 開発の流れ

### 1. プロジェクトセットアップ
1. バックエンドプロジェクト作成
2. フロントエンドプロジェクト作成
3. 依存関係のインストール

### 2. バックエンド開発
1. Entity/DTOの作成
2. MyBatis Mapperの実装
3. Serviceレイヤーの実装
4. Controllerの実装
5. Swagger確認

### 3. フロントエンド開発
1. TypeScript型定義の作成
2. API Serviceの実装
3. Reactコンポーネントの実装
4. ページの実装
5. ルーティング設定

### 4. 連携テスト
1. バックエンド起動 (port: 8080)
2. フロントエンド起動 (port: 5173)
3. CRUD操作の確認
4. ファイル入出力の確認

---

## 用語解説

### スケルトンコード
プロジェクトの基本的な骨組みとなるコード群。以下を含む：
- ディレクトリ構造
- 設定ファイル (build.gradle, package.json等)
- 基本クラス/インターフェースの空実装
- 共通機能 (API通信基盤、エラーハンドリング)
- サンプル実装 (1つの機能の実装例)

**メリット:**
- すぐに開発を開始できる
- プロジェクト全体の構造が明確
- チーム開発時の規約・パターンを統一
- 設定ミスを防げる

---

## 注意事項

### Tomcatについて
- Apache Tomcatを使用してWebアプリケーションをデプロイ
- Spring BootアプリケーションをWAR形式でパッケージング
- Tomcatのバージョン: 9.x または 10.x を推奨
- デプロイ方法: WARファイルをwebappsディレクトリに配置

### Swaggerについて
- `springdoc-openapi-starter-webmvc-ui` を追加する必要あり
- Spring Boot 3以降では自動で組み込まれない
- Controllerにアノテーションを付けると自動的にAPI仕様が生成される

---

## 次のステップ

1. スケルトンコードの生成
2. 基本的なCRUD機能の実装
3. ファイル入出力機能の実装
4. UI/UXの改善
5. テストコードの追加

---

## 参考リンク

- Spring Boot公式: https://spring.io/projects/spring-boot
- MyBatis公式: https://mybatis.org/mybatis-3/
- React公式: https://react.dev/
- TypeScript公式: https://www.typescriptlang.org/
- Vite公式: https://vitejs.dev/